<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iPDFall</title>
  <style>
    body { margin:0; font-family:Arial, sans-serif; background:#111; color:#fff; text-align:center; }
    header { padding:20px; font-size:2em; font-weight:bold; }
    .hearts { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin:20px; }
    .heart { width:140px; height:120px; position:relative; display:flex; justify-content:center; align-items:center;
             background:red; transform:rotate(-45deg); cursor:pointer; color:#fff; font-weight:bold; font-size:0.9em; }
    .heart:before, .heart:after { content:''; position:absolute; width:140px; height:140px; border-radius:50%; background:red; }
    .heart:before { top:-70px; left:0; }
    .heart:after { left:70px; top:0; }
    .heart span { transform:rotate(45deg); z-index:2; text-align:center; }
    section { margin:40px auto; padding:20px; max-width:600px; background:#222; border-radius:12px; }
    button { padding:10px 20px; margin-top:10px; border:none; border-radius:8px; background:#ff4081; color:#fff; cursor:pointer; }
    footer { margin:40px 0; font-size:0.9em; }
    canvas { position:fixed; top:0; left:0; z-index:-1; }
  </style>
</head>
<body>
  <canvas id="bg"></canvas>
  <header>ðŸ’– iPDFall ðŸ’–</header>
  <div class="hearts">
    <div class="heart" onclick="showTool('merge')"><span>Merge PDF</span></div>
    <div class="heart" onclick="showTool('split')"><span>Split PDF</span></div>
    <div class="heart" onclick="showTool('compress')"><span>Compress</span></div>
    <div class="heart" onclick="showTool('img2pdf')"><span>Images â†’ PDF</span></div>
    <div class="heart" onclick="showTool('pdf2img')"><span>PDF â†’ Images</span></div>
    <div class="heart" onclick="showTool('reorder')"><span>Reorder Pages</span></div>
    <div class="heart" onclick="showTool('watermark')"><span>Watermark</span></div>
  </div>
  <div id="tools"></div>
  <footer>
    ðŸ“ž +971561581606 | ðŸ“§ iqusmart12@gmail.com <br>
    <small>All tools run in your browser. No files uploaded.</small>
  </footer>

  <!-- CDN scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    // Background 3D animation
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({canvas:document.getElementById('bg')});
    renderer.setSize(window.innerWidth, window.innerHeight);
    const geometry = new THREE.TorusKnotGeometry(10,3,100,16);
    const material = new THREE.MeshNormalMaterial();
    const torusKnot = new THREE.Mesh(geometry, material);
    scene.add(torusKnot);
    camera.position.z = 50;
    function animate(){ requestAnimationFrame(animate); torusKnot.rotation.x+=0.01; torusKnot.rotation.y+=0.01; renderer.render(scene,camera);} animate();
    window.addEventListener('resize', ()=>{ renderer.setSize(window.innerWidth, window.innerHeight); camera.aspect=window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); });

    // Tools UI
    function showTool(tool){
      const tools=document.getElementById('tools');
      tools.innerHTML='';
      if(tool==='merge'){
        tools.innerHTML='<section><h2>Merge PDFs</h2><input type="file" id="mergeFiles" multiple accept="application/pdf"><br><button onclick="mergePDFs()">Merge</button></section>';
      }
      if(tool==='split'){
        tools.innerHTML='<section><h2>Split PDF</h2><input type="file" id="splitFile" accept="application/pdf"><br><input type="text" id="splitPages" placeholder="e.g. 1-3,5"><br><button onclick="splitPDF()">Split</button></section>';
      }
      if(tool==='compress'){
        tools.innerHTML='<section><h2>Compress PDF</h2><input type="file" id="compressFile" accept="application/pdf"><br><button onclick="compressPDF()">Compress</button></section>';
      }
      if(tool==='img2pdf'){
        tools.innerHTML='<section><h2>Images â†’ PDF</h2><input type="file" id="imgFiles" multiple accept="image/*"><br><button onclick="imagesToPDF()">Convert</button></section>';
      }
      if(tool==='pdf2img'){
        tools.innerHTML='<section><h2>PDF â†’ Images</h2><input type="file" id="pdf2imgFile" accept="application/pdf"><br><button onclick="pdfToImages()">Convert</button></section>';
      }
      if(tool==='reorder'){
        tools.innerHTML='<section><h2>Reorder Pages</h2><input type="file" id="reorderFile" accept="application/pdf"><br><input type="text" id="pageOrder" placeholder="New order e.g. 2,1,3"><br><button onclick="reorderPDF()">Reorder</button></section>';
      }
      if(tool==='watermark'){
        tools.innerHTML='<section><h2>Watermark</h2><input type="file" id="wmFile" accept="application/pdf"><br><input type="text" id="wmText" placeholder="Watermark text"><br><button onclick="addWatermark()">Add</button></section>';
      }
    }

    // PDF Functions
    async function mergePDFs(){
      const files=document.getElementById('mergeFiles').files;
      if(!files.length) return;
      const mergedPdf=await PDFLib.PDFDocument.create();
      for(let file of files){
        const bytes=await file.arrayBuffer();
        const pdf=await PDFLib.PDFDocument.load(bytes);
        const copied=await mergedPdf.copyPages(pdf,pdf.getPageIndices());
        copied.forEach(p=>mergedPdf.addPage(p));
      }
      const mergedBytes=await mergedPdf.save();
      saveAs(new Blob([mergedBytes],{type:'application/pdf'}),'merged.pdf');
    }

    async function splitPDF(){
      const file=document.getElementById('splitFile').files[0];
      if(!file) return;
      const pagesStr=document.getElementById('splitPages').value;
      const bytes=await file.arrayBuffer();
      const pdf=await PDFLib.PDFDocument.load(bytes);
      const ranges=pagesStr.split(',').map(r=>r.split('-').map(n=>parseInt(n.trim())));
      let zip=new JSZip();
      for(let r of ranges){
        let start=r[0]-1,end=(r.length>1?r[1]-1:r[0]-1);
        const newPdf=await PDFLib.PDFDocument.create();
        const copied=await newPdf.copyPages(pdf,pdf.getPageIndices().slice(start,end+1));
        copied.forEach(p=>newPdf.addPage(p));
        const newBytes=await newPdf.save();
        zip.file('split_'+r.join('-')+'.pdf',newBytes);
      }
      const zipData=await zip.generateAsync({type:'blob'});
      saveAs(zipData,'split_pdfs.zip');
    }

    async function compressPDF(){
      const file=document.getElementById('compressFile').files[0];
      if(!file) return;
      const bytes=await file.arrayBuffer();
      const pdf=await PDFLib.PDFDocument.load(bytes);
      const newPdf=await PDFLib.PDFDocument.create();
      for(let i=0;i<pdf.getPageCount();i++){
        const [page]=await newPdf.copyPages(pdf,[i]);
        newPdf.addPage(page);
      }
      const newBytes=await newPdf.save({useObjectStreams:true});
      saveAs(new Blob([newBytes],{type:'application/pdf'}),'compressed.pdf');
    }

    async function imagesToPDF(){
      const files=document.getElementById('imgFiles').files;
      if(!files.length) return;
      const pdf=await PDFLib.PDFDocument.create();
      for(let f of files){
        const bytes=await f.arrayBuffer();
        let img;
        if(f.type==='image/jpeg') img=await pdf.embedJpg(bytes);
        else img=await pdf.embedPng(bytes);
        const page=pdf.addPage([img.width,img.height]);
        page.drawImage(img,{x:0,y:0,width:img.width,height:img.height});
      }
      const pdfBytes=await pdf.save();
      saveAs(new Blob([pdfBytes],{type:'application/pdf'}),'images.pdf');
    }

    async function pdfToImages(){
      const file=document.getElementById('pdf2imgFile').files[0];
      if(!file) return;
      const bytes=await file.arrayBuffer();
      const pdf=await pdfjsLib.getDocument({data:bytes}).promise;
      let zip=new JSZip();
      for(let i=1;i<=pdf.numPages;i++){
        const page=await pdf.getPage(i);
        const viewport=page.getViewport({scale:2});
        const canvas=document.createElement('canvas');
        const ctx=canvas.getContext('2d');
        canvas.width=viewport.width; canvas.height=viewport.height;
        await page.render({canvasContext:ctx,viewport}).promise;
        const blob=await new Promise(r=>canvas.toBlob(r,'image/png'));
        zip.file('page_'+i+'.png',blob);
      }
      const zipData=await zip.generateAsync({type:'blob'});
      saveAs(zipData,'pdf_images.zip');
    }

    async function reorderPDF(){
      const file=document.getElementById('reorderFile').files[0];
      if(!file) return;
      const order=document.getElementById('pageOrder').value.split(',').map(n=>parseInt(n.trim())-1);
      const bytes=await file.arrayBuffer();
      const pdf=await PDFLib.PDFDocument.load(bytes);
      const newPdf=await PDFLib.PDFDocument.create();
      for(let i of order){
        const [page]=await newPdf.copyPages(pdf,[i]);
        newPdf.addPage(page);
      }
      const newBytes=await newPdf.save();
      saveAs(new Blob([newBytes],{type:'application/pdf'}),'reordered.pdf');
    }

    async function addWatermark(){
      const file=document.getElementById('wmFile').files[0];
      const text=document.getElementById('wmText').value;
      if(!file||!text) return;
      const bytes=await file.arrayBuffer();
      const pdf=await PDFLib.PDFDocument.load(bytes);
      const pages=pdf.getPages();
      pages.forEach(p=>p.drawText(text,{x:50,y:50,size:50,opacity:0.3,rotate:PDFLib.degrees(45)}));
      const newBytes=await pdf.save();
      saveAs(new Blob([newBytes],{type:'application/pdf'}),'watermarked.pdf');
    }
  </script>
</body>
</html>
